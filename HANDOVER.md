# 🚬 煙草の行き先 — 開発引き継ぎメモ

## プロジェクト概要

現在地から**喫煙可能な飲食店**を検索できるシンプルなWebアプリ。  
ホットペッパーグルメAPIを使用。サーバーレス・HTMLファイル1枚構成。

---

## 現在の構成

```
smoking-finder.html   ← これだけで動く完成品
```

### 動作フロー
1. ユーザーがAPIキーを入力（localStorageに保存）
2. 「現在地から探す」ボタンを押す
3. ブラウザの `navigator.geolocation` で緯度経度を取得
4. ホットペッパーAPIに `lat/lng/range/non_smoking=0` を投げる
5. 結果をカード形式で表示、タップでホットペッパー店舗ページへ遷移

---

## API情報

### ホットペッパーグルメAPI

| 項目 | 内容 |
|------|------|
| 登録URL | https://webservice.recruit.co.jp/ |
| APIキー | 取得済み（再発行推奨） |
| 利用制限 | 非商用のみ無料 |

### グルメサーチAPIエンドポイント

```
GET http://webservice.recruit.co.jp/hotpepper/gourmet/v1/
```

### 現在使用中のパラメータ

| パラメータ | 値 | 意味 |
|-----------|-----|------|
| `key` | APIキー | 認証 |
| `lat` / `lng` | 現在地の緯度経度 | 位置指定 |
| `range` | `3` | 検索半径1km |
| `non_smoking` | `0` | 喫煙可のみ |
| `count` | `10` | 取得件数 |
| `keyword` | 任意入力値 | フリーワード |
| `format` | `json` | レスポンス形式 |

### 使えるその他の主要パラメータ（拡張時に活用）

| パラメータ | 値 | 意味 |
|-----------|-----|------|
| `non_smoking` | `1` | 禁煙のみに絞る |
| `range` | `1〜5` | 300m/500m/1km/2km/3km |
| `genre` | `G001`など | ジャンル絞り込み |
| `private_room` | `1` | 個室あり |
| `free_drink` | `1` | 飲み放題あり |
| `count` | `1〜100` | 取得件数 |
| `start` | 数値 | ページネーション |

### 主要ジャンルコード

| コード | ジャンル |
|--------|---------|
| G001 | 居酒屋 |
| G002 | ダイニングバー・バル |
| G004 | 創作料理 |
| G005 | 和食 |
| G006 | 洋食 |
| G007 | イタリアン・フレンチ |
| G008 | 中華 |
| G017 | 焼肉・ホルモン |

### 主要エリアコード（large_area）

| コード | エリア |
|--------|--------|
| Z011 | 東京 |
| Z012 | 神奈川 |
| Z013 | 埼玉 |
| Z014 | 千葉 |
| Z021 | 大阪 |
| Z022 | 兵庫 |
| Z023 | 京都 |
| Z033 | 愛知 |
| Z061 | 福岡 |

---

## 現在の課題・改善候補

### UX面
- [ ] 検索範囲（距離）をユーザーが選べるようにする（300m〜3km）
- [ ] ジャンル絞り込みUI（居酒屋・焼肉・バーなど）
- [ ] 結果の地図表示（Google Maps埋め込みなど）
- [ ] 「もっと見る」ページネーション
- [ ] 営業時間表示

### 技術面
- [ ] APIキーをフロントに持つのは暫定。本番運用するならバックエンド経由に変更
- [ ] エラーハンドリングの強化（位置情報拒否時のエリア手動選択など）
- [ ] PWA化（スマホのホーム画面に追加できるようにする）
- [ ] React/Next.jsへの移行（スケールする場合）

### MCPサーバー（別途作成済み）
Claude DesktopやCursorから自然言語で検索できるMCPサーバーも作成済み。
`server.py` + `requirements.txt` として別ファイルで存在。

---

## デザインコンセプト

- **テーマ**: 煙草の煙・夜の街・アンバー色
- **フォント**: Zen Kaku Gothic New（日本語）+ Space Mono（コード・ラベル）
- **カラー**:
  - `#2a2520` — 背景（灰色がかった黒）
  - `#e8a227` — アクセント（琥珀色）
  - `#d4521a` — エンファシス（燠色）
  - `#f5f0e8` — テキスト（紙色）
  - `#8a8278` — サブテキスト（霧色）

---

## Cursorでの開発を始めるには

```bash
# リポジトリ構成の提案
mkdir smoking-finder
cd smoking-finder
cp smoking-finder.html index.html

# 拡張するならViteで始める
npm create vite@latest . -- --template vanilla
# or React
npm create vite@latest . -- --template react-ts
```

### Cursorに渡すと良いプロンプト例

```
このファイルをベースに、検索範囲をスライダーで選べるようにして。
デザインはそのまま維持すること。
```

```
ジャンル選択ボタン（居酒屋/焼肉/バー）を追加して。
APIのgenreパラメータを使う。
```

```
結果カードに距離（何m先）を表示したい。
APIレスポンスのどのフィールドを使えばいい？
```
